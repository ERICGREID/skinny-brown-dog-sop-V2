<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://apis.google.com/js/api.js"></script>
<script src="https://accounts.google.com/gsi/client"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skinny Brown Dog Media - Publishing Workflow Tracker</title>
    <style>
        :root {
            --primary: #1a56db;
            --primary-dark: #1e429f;
            --secondary: #64748b;
            --accent: #3b82f6;
            --light: #f3f4f6;
            --white: #ffffff;
            --gray-100: #f9fafb;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--gray-100);
            color: var(--gray-700);
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: var(--white);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            padding: 40px;
            border-radius: 8px;
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--gray-200);
        }
        
        header img {
            max-width: 300px;
            margin-bottom: 20px;
        }
        
        h1 {
            color: var(--primary);
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        h2 {
            color: var(--primary);
            margin: 30px 0 15px;
            padding-bottom: 5px;
            border-bottom: 2px solid var(--accent);
            font-size: 20px;
        }
        
        h3 {
            color: var(--secondary);
            margin: 20px 0 10px;
            font-size: 18px;
        }
        
        .project-info {
            background-color: var(--light);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .project-info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .info-item {
            margin-bottom: 15px;
        }
        
        .info-item label {
            display: block;
            font-weight: bold;
            color: var(--secondary);
            margin-bottom: 5px;
        }
        
        .info-item input[type="text"],
        .info-item input[type="date"],
        .info-item input[type="password"],
        .info-item textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--gray-300);
            border-radius: 4px;
            font-family: inherit;
        }
        
        .info-item input[type="password"] {
            font-family: 'password';
            letter-spacing: 2px;
        }
        
        .phase-container {
            margin-bottom: 40px;
            border: 1px solid var(--gray-300);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .phase-header {
            background-color: var(--primary);
            color: var(--white);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }
        
        .phase-header h2 {
            margin: 0;
            padding: 0;
            border: none;
            color: var(--white);
        }
        
        .phase-header .status {
            font-size: 14px;
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 20px;
            background-color: var(--white);
        }
        
        .status-not-started {
            color: var(--gray-600);
        }
        
        .status-in-progress {
            color: var(--accent);
        }
        
        .status-completed {
            color: var(--success);
        }
        
        .phase-content {
            padding: 20px;
            background-color: var(--white);
        }
        
        .phase-container.collapsed .phase-content {
            display: none;
        }
        
        .phase-header:after {
            content: "▼";
            font-size: 12px;
            transition: transform 0.3s;
        }
        
        .phase-container.collapsed .phase-header:after {
            transform: rotate(-90deg);
        }
        
        .task-list {
            list-style-type: none;
        }
        
        .task-item {
            padding: 12px;
            margin-bottom: 10px;
            border: 1px solid var(--gray-200);
            border-radius: 4px;
            display: flex;
            align-items: center;
        }
        
        .task-item:hover {
            background-color: var(--gray-100);
        }
        
        .task-item input[type="checkbox"] {
            margin-right: 10px;
            width: 20px;
            height: 20px;
        }
        
        .task-item.completed {
            background-color: var(--light);
            border-color: var(--success);
        }
        
        .task-item.completed label {
            text-decoration: line-through;
            color: var(--gray-500);
        }
        
        .isbn-section {
            background-color: var(--light);
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .isbn-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .platform-section {
            background-color: var(--light);
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .platform-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
        }
        
        .platform-card {
            background-color: var(--white);
            border: 1px solid var(--gray-300);
            border-radius: 8px;
            padding: 15px;
        }
        
        .platform-card h3 {
            color: var(--primary);
            margin-top: 0;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--gray-200);
        }
        
        .transition-arrow {
            text-align: center;
            font-size: 24px;
            color: var(--primary);
            margin: 20px 0;
        }
        
        .payment-milestone {
            background-color: var(--accent);
            color: var(--white);
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            font-weight: bold;
            text-align: center;
        }
        
        .actions {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: var(--primary-dark);
        }
        
        button.secondary {
            background-color: var(--gray-300);
            color: var(--gray-700);
        }
        
        button.secondary:hover {
            background-color: var(--gray-400);
        }
        
        button.success {
            background-color: var(--success);
        }
        
        button.warning {
            background-color: var(--warning);
        }
        
        .timeline {
            position: relative;
            margin: 40px 0;
            padding-left: 50px;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 20px;
            top: 0;
            bottom: 0;
            width: 4px;
            background-color: var(--primary);
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 30px;
            padding: 20px;
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -34px;
            top: 20px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: var(--white);
            border: 4px solid var(--primary);
        }
        
        .timeline-date {
            display: inline-block;
            padding: 5px 10px;
            background-color: var(--light);
            border-radius: 4px;
            font-size: 14px;
            margin-bottom: 10px;
        }
        
        .progress-container {
            width: 100%;
            height: 10px;
            background-color: var(--gray-200);
            border-radius: 5px;
            overflow: hidden;
            margin-top: 5px;
        }
        
        .progress-bar {
            height: 100%;
            background-color: var(--accent);
            transition: width 0.3s ease;
        }
        
        .import-export-section {
            margin-top: 40px;
            padding: 20px;
            background-color: var(--light);
            border-radius: 8px;
        }
        
        .file-input {
            display: none;
        }
        
        .file-label {
            display: inline-block;
            background-color: var(--primary);
            color: white;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .file-name {
            display: inline-block;
            margin-left: 10px;
            font-style: italic;
        }
        
        footer {
            margin-top: 40px;
            text-align: center;
            color: var(--gray-500);
            font-size: 12px;
            border-top: 1px solid var(--gray-300);
            padding-top: 20px;
        }
        
        /* Project selector */
        .project-selector {
            margin-bottom: 30px;
            display: flex;
            gap: 15px;
            align-items: center;
            background-color: var(--gray-100);
            padding: 15px;
            border-radius: 8px;
        }
        
        .project-selector select {
            padding: 8px;
            border: 1px solid var(--gray-300);
            border-radius: 4px;
            flex-grow: 1;
        }
        
        .project-management-btns {
            display: flex;
            gap: 10px;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .project-info-grid,
            .isbn-grid,
            .platform-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 20px;
            }
            
            .platform-grid {
                gap: 15px;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .actions button {
                width: 100%;
            }
            
            .project-selector {
                flex-direction: column;
                align-items: stretch;
            }
        }

        @media print {
            body {
                background-color: var(--white);
                padding: 0;
            }
            
            .container {
                box-shadow: none;
                max-width: 100%;
            }
            
            .actions,
            .project-selector,
            .import-export-section {
                display: none;
            }
            
            .phase-container.collapsed .phase-content {
                display: block;
            }
            
            @page {
                size: letter;
                margin: 0.5in;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <img src="https://via.placeholder.com/300x80?text=Skinny+Brown+Dog+Media" alt="Skinny Brown Dog Media Logo">
            <h1>Book Publishing Workflow Tracker</h1>
        </header>
        
        <!-- Project Selector -->
        <div class="project-selector">
            <select id="projectSelect">
                <option value="">-- Select a saved project --</option>
            </select>
            <div class="project-management-btns">
                <button type="button" id="loadProjectBtn" class="secondary">Load</button>
                <button type="button" id="newProjectBtn">New Project</button>
                <button type="button" id="deleteProjectBtn" class="warning">Delete</button>
            </div>
        </div>
        
        <div class="project-info">
            <h2>Book Project Information</h2>
            <div class="project-info-grid">
                <div class="info-item">
                    <label for="bookTitle">Book Title:</label>
                    <input type="text" id="bookTitle" name="bookTitle" required>
                </div>
                <div class="info-item">
                    <label for="authorName">Author Name:</label>
                    <input type="text" id="authorName" name="authorName" required>
                </div>
                <div class="info-item">
                    <label for="startDate">Project Start Date:</label>
                    <input type="date" id="startDate" name="startDate" required>
                </div>
                <div class="info-item">
                    <label for="pubDate">Target Publication Date:</label>
                    <input type="date" id="pubDate" name="pubDate" required>
                </div>
                <div class="info-item">
                    <label for="projectManager">Project Manager:</label>
                    <input type="text" id="projectManager" name="projectManager" required>
                </div>
                <div class="info-item">
                    <label for="currentStatus">Current Project Status:</label>
                    <input type="text" id="currentStatus" name="currentStatus" value="Not Started" readonly>
                    <div class="progress-container">
                        <div class="progress-bar" id="overallProgress" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Pre-Manuscript Phase -->
        <div class="phase-container" id="phase1Container">
            <div class="phase-header" onclick="togglePhase('phase1Container')">
                <h2>Pre-Manuscript Phase</h2>
                <span class="status status-not-started" id="phase1Status">Not Started</span>
            </div>
            <div class="phase-content">
                <div class="info-item">
                    <label for="authorGmail">Author Gmail:</label>
                    <input type="text" id="authorGmail" name="authorGmail">
                </div>
                <div class="info-item">
                    <label for="authorGmailPass">Gmail Password (stored securely):</label>
                    <input type="password" id="authorGmailPass" name="authorGmailPass">
                </div>
                <div class="info-item">
                    <label for="stripeLogin">Stripe Login:</label>
                    <input type="text" id="stripeLogin" name="stripeLogin">
                </div>
                <div class="info-item">
                    <label for="stripePass">Stripe Password (stored securely):</label>
                    <input type="password" id="stripePass" name="stripePass">
                </div>
                
                <div class="isbn-section">
                    <h3>ISBN Assignment</h3>
                    <div class="isbn-grid">
                        <div class="info-item">
                            <label for="isbnEbook">eBook ISBN:</label>
                            <input type="text" id="isbnEbook" name="isbnEbook">
                        </div>
                        <div class="info-item">
                            <label for="isbnPaperback">Paperback ISBN:</label>
                            <input type="text" id="isbnPaperback" name="isbnPaperback">
                        </div>
                        <div class="info-item">
                            <label for="isbnCaseLaminate">Case Laminate ISBN:</label>
                            <input type="text" id="isbnCaseLaminate" name="isbnCaseLaminate">
                        </div>
                        <div class="info-item">
                            <label for="isbnDustJacket">Dust Jacket ISBN:</label>
                            <input type="text" id="isbnDustJacket" name="isbnDustJacket">
                        </div>
                    </div>
                </div>
                
                <h3>Tasks</h3>
                <ul class="task-list">
                    <li class="task-item">
                        <input type="checkbox" id="task1" name="task1">
                        <label for="task1">Schedule discovery/lead follow-up call</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task2" name="task2">
                        <label for="task2">Send welcome package with publishing agreement</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task3" name="task3">
                        <label for="task3">Receive signed agreement</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task4" name="task4">
                        <label for="task4">Receive FIRST PAYMENT (50%)</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task5" name="task5">
                        <label for="task5">Create author folder in Google Drive</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task6" name="task6">
                        <label for="task6">Create entry in Employee Task Tracker</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task7" name="task7">
                        <label for="task7">Set up author Gmail account</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task8" name="task8">
                        <label for="task8">Set up author Stripe account</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task9" name="task9">
                        <label for="task9">Assign ISBNs to project</label>
                    </li>
                </ul>
            </div>
        </div>
        
        <div class="payment-milestone">
            FIRST PAYMENT (50%) - Due upon signing publishing agreement
        </div>
        
        <!-- Manuscript Development Phase -->
        <div class="phase-container" id="phase2Container">
            <div class="phase-header" onclick="togglePhase('phase2Container')">
                <h2>Manuscript Development Phase (3 Months)</h2>
                <span class="status status-not-started" id="phase2Status">Not Started</span>
            </div>
            <div class="phase-content">
                <h3>Tasks</h3>
                <ul class="task-list">
                    <li class="task-item">
                        <input type="checkbox" id="task10" name="task10">
                        <label for="task10">Receive draft manuscript or author notes</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task11" name="task11">
                        <label for="task11">Complete developmental editing (~6 weeks)</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task12" name="task12">
                        <label for="task12">Author implements developmental editing feedback</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task13" name="task13">
                        <label for="task13">Complete line/copy editing (~6 weeks)</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task14" name="task14">
                        <label for="task14">Author reviews and approves edits</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task15" name="task15">
                        <label for="task15"><strong>MILESTONE: Approve Final Draft Copy of Manuscript</strong></label>
                    </li>
                </ul>
            </div>
        </div>
        
        <div class="transition-arrow">
            <i>↓ TRANSITION: Once final draft is approved, begin Beta Reader phase ↓</i>
        </div>
        
        <!-- Beta Reader Review Phase -->
        <div class="phase-container" id="phase3Container">
            <div class="phase-header" onclick="togglePhase('phase3Container')">
                <h2>Beta Reader Review Phase (30 Days)</h2>
                <span class="status status-not-started" id="phase3Status">Not Started</span>
            </div>
            <div class="phase-content">
                <h3>Tasks</h3>
                <ul class="task-list">
                    <li class="task-item">
                        <input type="checkbox" id="task16" name="task16">
                        <label for="task16">Create preliminary eBook version for beta readers</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task17" name="task17">
                        <label for="task17">Quality check preliminary eBook</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task18" name="task18">
                        <label for="task18">Send eBook to selected beta readers</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task19" name="task19">
                        <label for="task19">Provide Beta Reader Feedback Form to participants</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task20" name="task20">
                        <label for="task20">Compile all beta reader feedback</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task21" name="task21">
                        <label for="task21">Present organized feedback to author</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task22" name="task22">
                        <label for="task22">Make final manuscript adjustments based on feedback</label>
                    </li>
                </ul>
            </div>
        </div>
        
        <div class="transition-arrow">
            <i>↓ TRANSITION: After final manuscript adjustments, begin Production phase ↓</i>
        </div>
        
        <!-- Production Phase -->
        <div class="phase-container" id="phase4Container">
            <div class="phase-header" onclick="togglePhase('phase4Container')">
                <h2>Production Phase (2 Months)</h2>
                <span class="status status-not-started" id="phase4Status">Not Started</span>
            </div>
            <div class="phase-content">
                <h3>Tasks</h3>
                <ul class="task-list">
                    <li class="task-item">
                        <input type="checkbox" id="task23" name="task23">
                        <label for="task23">Begin interior formatting based on final manuscript (30 days)</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task24" name="task24">
                        <label for="task24">Submit cover design request</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task25" name="task25">
                        <label for="task25">Receive first round of cover designs (2 weeks)</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task26" name="task26">
                        <label for="task26">Collect author feedback on cover designs</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task27" name="task27">
                        <label for="task27">Complete interior formatting</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task28" name="task28">
                        <label for="task28">Complete full cover design/layout</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task29" name="task29">
                        <label for="task29">Send completed interior and cover files to client for review</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task30" name="task30">
                        <label for="task30">Collect and implement feedback on production files</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task31" name="task31">
                        <label for="task31">Receive SECOND PAYMENT (50%)</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task32" name="task32">
                        <label for="task32"><strong>MILESTONE: Author Approval of All Production Files</strong></label>
                    </li>
                </ul>
            </div>
        </div>
        
        <div class="payment-milestone">
            SECOND PAYMENT (50%) - Due upon approval of final production files
        </div>
        
        <div class="transition-arrow">
            <i>↓ TRANSITION: After all production files are approved, begin Account Setup phase ↓</i>
        </div>
        
        <!-- Account Setup Phase -->
        <div class="phase-container" id="phase5Container">
            <div class="phase-header" onclick="togglePhase('phase5Container')">
                <h2>Account Setup Phase (1-2 Weeks)</h2>
                <span class="status status-not-started" id="phase5Status">Not Started</span>
            </div>
            <div class="phase-content">
                <div class="platform-section">
                    <h3>Platform Accounts</h3>
                    <div class="platform-grid">
                        <div class="platform-card">
                            <h3>BookVault</h3>
                            <div class="info-item">
                                <label for="bookVaultLogin">Login:</label>
                                <input type="text" id="bookVaultLogin" name="bookVaultLogin">
                            </div>
                            <div class="info-item">
                                <label for="bookVaultPass">Password:</label>
                                <input type="password" id="bookVaultPass" name="bookVaultPass">
                            </div>
                        </div>
                        <div class="platform-card">
                            <h3>IngramSpark</h3>
                            <div class="info-item">
                                <label for="ingramLogin">Login:</label>
                                <input type="text" id="ingramLogin" name="ingramLogin">
                            </div>
                            <div class="info-item">
                                <label for="ingramPass">Password:</label>
                                <input type="password" id="ingramPass" name="ingramPass">
                            </div>
                        </div>
                        <div class="platform-card">
                            <h3>KDP</h3>
                            <div class="info-item">
                                <label for="kdpLogin">Login:</label>
                                <input type="text" id="kdpLogin" name="kdpLogin">
                            </div>
                            <div class="info-item">
                                <label for="kdpPass">Password:</label>
                                <input type="password" id="kdpPass" name="kdpPass">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="isbn-section">
                    <h3>ISBN Platform Usage</h3>
                    <p>Record which ISBN is used on each platform for each format:</p>
                    <table style="width: 100%; margin-top: 15px; border-collapse: collapse;">
                        <thead>
                            <tr style="background-color: var(--primary); color: white;">
                                <th style="padding: 10px; text-align: left; border: 1px solid var(--gray-300);">Format</th>
                                <th style="padding: 10px; text-align: left; border: 1px solid var(--gray-300);">ISBN</th>
                                <th style="padding: 10px; text-align: left; border: 1px solid var(--gray-300);">BookVault</th>
                                <th style="padding: 10px; text-align: left; border: 1px solid var(--gray-300);">IngramSpark</th>
                                <th style="padding: 10px; text-align: left; border: 1px solid var(--gray-300);">KDP</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);">eBook</td>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);"><span id="ebookIsbnDisplay"></span></td>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);">
                                    <input type="checkbox" id="ebookBookVault" name="ebookBookVault" checked disabled>
                                </td>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);">
                                    <input type="checkbox" id="ebookIngram" name="ebookIngram" disabled>
                                </td>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);">
                                    <input type="checkbox" id="ebookKDP" name="ebookKDP" checked disabled>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);">Paperback</td>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);"><span id="paperbackIsbnDisplay"></span></td>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);">
                                    <input type="checkbox" id="paperbackBookVault" name="paperbackBookVault" checked disabled>
                                </td>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);">
                                    <input type="checkbox" id="paperbackIngram" name="paperbackIngram" checked disabled>
                                </td>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);">
                                    <input type="checkbox" id="paperbackKDP" name="paperbackKDP" checked disabled>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);">Case Laminate</td>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);"><span id="laminateIsbnDisplay"></span></td>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);">
                                    <input type="checkbox" id="laminateBookVault" name="laminateBookVault" checked disabled>
                                </td>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);">
                                    <input type="checkbox" id="laminateIngram" name="laminateIngram" checked disabled>
                                </td>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);">
                                    <input type="checkbox" id="laminateKDP" name="laminateKDP" disabled>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);">Dust Jacket</td>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);"><span id="dustjacketIsbnDisplay"></span></td>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);">
                                    <input type="checkbox" id="dustjacketBookVault" name="dustjacketBookVault" checked disabled>
                                </td>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);">
                                    <input type="checkbox" id="dustjacketIngram" name="dustjacketIngram" checked disabled>
                                </td>
                                <td style="padding: 10px; border: 1px solid var(--gray-300);">
                                    <input type="checkbox" id="dustjacketKDP" name="dustjacketKDP" disabled>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3>Tasks</h3>
                <ul class="task-list">
                    <li class="task-item">
                        <input type="checkbox" id="task33" name="task33">
                        <label for="task33">Create BookVault account</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task34" name="task34">
                        <label for="task34">Create IngramSpark account</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task35" name="task35">
                        <label for="task35">Create KDP account</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task36" name="task36">
                        <label for="task36">Verify ISBN assignments across all platforms</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task37" name="task37">
                        <label for="task37">Configure correct distribution settings on each platform</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task38" name="task38">
                        <label for="task38">Set up proper metadata and pricing structure</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task39" name="task39">
                        <label for="task39">Verify no conflicts between distribution channels</label>
                    </li>
                </ul>
            </div>
        </div>
        
        <!-- File Upload & QA Phase -->
        <div class="phase-container" id="phase6Container">
            <div class="phase-header" onclick="togglePhase('phase6Container')">
                <h2>File Upload & Quality Control (1-2 Weeks)</h2>
                <span class="status status-not-started" id="phase6Status">Not Started</span>
            </div>
            <div class="phase-content">
                <h3>Tasks</h3>
                <ul class="task-list">
                    <li class="task-item">
                        <input type="checkbox" id="task40" name="task40">
                        <label for="task40">Upload interior PDF and cover files to BookVault</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task41" name="task41">
                        <label for="task41">Upload interior PDF and cover files to IngramSpark</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task42" name="task42">
                        <label for="task42">Upload interior PDF, cover files, and EPUB to KDP</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task43" name="task43">
                        <label for="task43">Complete all metadata fields on all platforms</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task44" name="task44">
                        <label for="task44">Set up pricing according to agreed strategy</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task45" name="task45">
                        <label for="task45">Order proof copies from all platforms</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task46" name="task46">
                        <label for="task46">Conduct internal review for quality issues</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task47" name="task47">
                        <label for="task47">Send proof copies to author for review</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task48" name="task48">
                        <label for="task48">Collect completed Proof Approval Form</label>
                    </li>
                </ul>
            </div>
        </div>
        
        <!-- Publication Phase -->
        <div class="phase-container" id="phase7Container">
            <div class="phase-header" onclick="togglePhase('phase7Container')">
                <h2>Publication Phase - Platform Release Schedule</h2>
                <span class="status status-not-started" id="phase7Status">Not Started</span>
            </div>
            <div class="phase-content">
                <div class="info-item">
                    <label for="launchDate">Official Launch Date:</label>
                    <input type="date" id="launchDate" name="launchDate">
                </div>
                
                <div class="timeline">
                    <div class="timeline-item">
                        <span class="timeline-date">Day 1</span>
                        <h3>BookVault Release</h3>
                        <ul class="task-list">
                            <li class="task-item">
                                <input type="checkbox" id="task49" name="task49">
                                <label for="task49">Activate BookVault listing</label>
                            </li>
                            <li class="task-item">
                                <input type="checkbox" id="task50" name="task50">
                                <label for="task50">Initialize BookVault marketing tools</label>
                            </li>
                            <li class="task-item">
                                <input type="checkbox" id="task51" name="task51">
                                <label for="task51">Verify BookVault payment processing</label>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="timeline-item">
                        <span class="timeline-date">Day 3-5</span>
                        <h3>KDP Release</h3>
                        <ul class="task-list">
                            <li class="task-item">
                                <input type="checkbox" id="task52" name="task52">
                                <label for="task52">Submit for Amazon Kindle eBook availability</label>
                            </li>
                            <li class="task-item">
                                <input type="checkbox" id="task53" name="task53">
                                <label for="task53">Submit for Amazon paperback publication</label>
                            </li>
                            <li class="task-item">
                                <input type="checkbox" id="task54" name="task54">
                                <label for="task54">Verify KDP listings are live (may take 72 hours)</label>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="timeline-item">
                        <span class="timeline-date">Day 7-10</span>
                        <h3>IngramSpark Release</h3>
                        <ul class="task-list">
                            <li class="task-item">
                                <input type="checkbox" id="task55" name="task55">
                                <label for="task55">Activate global distribution channels</label>
                            </li>
                            <li class="task-item">
                                <input type="checkbox" id="task56" name="task56">
                                <label for="task56">Enable bookstore and library availability</label>
                            </li>
                            <li class="task-item">
                                <input type="checkbox" id="task57" name="task57">
                                <label for="task57">Complete distribution settings</label>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="timeline-item">
                        <span class="timeline-date">Day 10-14</span>
                        <h3>Launch Announcement</h3>
                        <ul class="task-list">
                            <li class="task-item">
                                <input type="checkbox" id="task58" name="task58">
                                <label for="task58">Send Book Launch Announcement Email</label>
                            </li>
                            <li class="task-item">
                                <input type="checkbox" id="task59" name="task59">
                                <label for="task59">Provide author with all retail links</label>
                            </li>
                            <li class="task-item">
                                <input type="checkbox" id="task60" name="task60">
                                <label for="task60">Add book to Skinny Brown Dog Media website</label>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Post-Publication Support -->
        <div class="phase-container" id="phase8Container">
            <div class="phase-header" onclick="togglePhase('phase8Container')">
                <h2>Post-Publication Support</h2>
                <span class="status status-not-started" id="phase8Status">Not Started</span>
            </div>
            <div class="phase-content">
                <h3>30-Day Follow-up</h3>
                <ul class="task-list">
                    <li class="task-item">
                        <input type="checkbox" id="task61" name="task61">
                        <label for="task61">Send 30-Day Check-In Email</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task62" name="task62">
                        <label for="task62">Review initial sales performance</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task63" name="task63">
                        <label for="task63">Address any distribution issues</label>
                    </li>
                </ul>
                
                <h3>90-Day Support Meeting</h3>
                <ul class="task-list">
                    <li class="task-item">
                        <input type="checkbox" id="task64" name="task64">
                        <label for="task64">Schedule 90-day review</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task65" name="task65">
                        <label for="task65">Prepare comprehensive review of book performance</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task66" name="task66">
                        <label for="task66">Develop ongoing marketing strategies</label>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" id="task67" name="task67">
                        <label for="task67">Plan for future promotions</label>
                    </li>
                </ul>
            </div>
        </div>
        
        <!-- Import/Export Section -->
        <div class="import-export-section">
            <h2>Import/Export Project Data</h2>
            <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                <div>
                    <input type="file" id="importFile" class="file-input" accept=".json">
                    <label for="importFile" class="file-label">Import Project</label>
                    <span id="fileName" class="file-name"></span>
                </div>
                <button type="button" id="exportButton" class="success">Export Project</button>
            </div>
        </div>
        
        <div class="actions">
            <button type="button" class="secondary" id="printButton">Print Workflow</button>
            <button type="button" id="saveButton">Save Progress</button>
            <button type="button" id="resetButton" class="warning">Reset Form</button>
        </div>
        
        <footer>
            © Skinny Brown Dog Media, 2025 | For internal use only
        </footer>
    </div>
    // Google Drive Integration
let isGDriveConnected = false;

// Initialize Google Drive API
function initGoogleDriveAPI() {
    // Check if gapi is loaded
    if (!window.gapi) {
        console.error('Google API client library not loaded');
        return;
    }
    
    const CLIENT_ID = '720585651306-eimrp5hqb6srs3r0gkht1qjj59hie2dk.apps.googleusercontent.com';
    const SCOPES = 'https://www.googleapis.com/auth/drive.file';
    
    // Update auth status to loading
    document.getElementById('auth-status').innerHTML = 'Initializing...';
    document.getElementById('auth-status').style.backgroundColor = '#fef3c7';
    
    // Load auth2 and drive APIs
    gapi.load('client:auth2', () => {
        gapi.client.init({
            clientId: CLIENT_ID,
            scope: SCOPES,
            discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest']
        }).then(() => {
            // Listen for sign-in state changes
            gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);
            
            // Handle the initial sign-in state
            updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
        }).catch(error => {
            console.error('Error initializing Google API', error);
            document.getElementById('auth-status').innerHTML = 'Error initializing: ' + error.message;
            document.getElementById('auth-status').style.backgroundColor = '#fee2e2';
        });
    });
}

// Update UI based on sign-in status
function updateSigninStatus(isSignedIn) {
    isGDriveConnected = isSignedIn;
    const authButton = document.getElementById('authButton');
    const saveButton = document.getElementById('saveToGDriveBtn');
    const loadButton = document.getElementById('loadFromGDriveBtn');
    const authStatus = document.getElementById('auth-status');
    
    if (isSignedIn) {
        authButton.innerHTML = 'Sign Out';
        authButton.onclick = handleSignoutClick;
        saveButton.disabled = false;
        saveButton.style.opacity = '1';
        loadButton.disabled = false;
        loadButton.style.opacity = '1';
        authStatus.innerHTML = 'Connected to Google Drive';
        authStatus.style.backgroundColor = '#d1fae5';
    } else {
        authButton.innerHTML = 'Connect to Google Drive';
        authButton.onclick = handleAuthClick;
        saveButton.disabled = true;
        saveButton.style.opacity = '0.5';
        loadButton.disabled = true;
        loadButton.style.opacity = '0.5';
        authStatus.innerHTML = 'Not connected to Google Drive';
        authStatus.style.backgroundColor = '#e5e7eb';
    }
}

// Handle login button click
function handleAuthClick() {
    gapi.auth2.getAuthInstance().signIn();
}

// Handle logout button click
function handleSignoutClick() {
    gapi.auth2.getAuthInstance().signOut();
}

// Save projects to Google Drive
function saveToGoogleDrive() {
    if (!isGDriveConnected) {
        alert('Please connect to Google Drive first');
        return;
    }
    
    // Get all projects from localStorage
    const projectsString = localStorage.getItem('publishingProjects');
    if (!projectsString || projectsString === '{}') {
        alert('No projects to export.');
        return;
    }
    
    const projects = JSON.parse(projectsString);
    const projectsJson = JSON.stringify(projects, null, 2);
    const fileName = `publishing-projects-export-${new Date().toISOString().slice(0, 10)}.json`;
    
    // Create a blob with the content
    const blob = new Blob([projectsJson], {type: 'application/json'});
    
    // Metadata for Google Drive
    const metadata = {
        'name': fileName,
        'mimeType': 'application/json',
    };
    
    // Get access token from current auth session
    const accessToken = gapi.auth.getToken().access_token;
    
    // Create FormData for multipart upload
    const form = new FormData();
    form.append('metadata', new Blob([JSON.stringify(metadata)], {type: 'application/json'}));
    form.append('file', blob);
    
    // Show loading indicator
    document.getElementById('auth-status').innerHTML = 'Saving to Google Drive...';
    document.getElementById('auth-status').style.backgroundColor = '#fef3c7';
    
    // Use fetch API to upload to Google Drive
    fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id,name,webViewLink', {
        method: 'POST',
        headers: new Headers({
            'Authorization': 'Bearer ' + accessToken
        }),
        body: form,
    })
    .then((response) => response.json())
    .then((data) => {
        if (data.id) {
            document.getElementById('auth-status').innerHTML = `File "${data.name}" successfully saved to Google Drive!`;
            document.getElementById('auth-status').style.backgroundColor = '#d1fae5';
            alert(`File "${data.name}" successfully saved to Google Drive!\nYou can access it at: ${data.webViewLink}`);
        } else {
            document.getElementById('auth-status').innerHTML = 'Error saving to Google Drive: ' + (data.error ? data.error.message : 'Unknown error');
            document.getElementById('auth-status').style.backgroundColor = '#fee2e2';
            alert('Error saving to Google Drive: ' + (data.error ? data.error.message : 'Unknown error'));
        }
    })
    .catch((error) => {
        document.getElementById('auth-status').innerHTML = 'Error uploading to Google Drive: ' + error.message;
        document.getElementById('auth-status').style.backgroundColor = '#fee2e2';
        alert('Error uploading to Google Drive: ' + error.message);
        console.error('Google Drive upload error:', error);
    });
}

// Load projects from Google Drive
function loadFromGoogleDrive() {
    if (!isGDriveConnected) {
        alert('Please connect to Google Drive first');
        return;
    }
    
    // Show loading indicator
    document.getElementById('auth-status').innerHTML = 'Searching for backups...';
    document.getElementById('auth-status').style.backgroundColor = '#fef3c7';
    
    // Search for JSON backup files
    gapi.client.drive.files.list({
        q: "mimeType='application/json' and name contains 'publishing-projects-export'",
        spaces: 'drive',
        fields: 'files(id, name, createdTime, webViewLink)'
    }).then(response => {
        const files = response.result.files;
        
        if (files && files.length > 0) {
            // Sort files by creation date (newest first)
            files.sort((a, b) => new Date(b.createdTime) - new Date(a.createdTime));
            
            // Create a dropdown for user to select which backup to load
            let selectHtml = '<select id="backup-select" style="width: 100%; padding: 8px; margin-bottom: 20px;">';
            files.forEach(file => {
                selectHtml += `<option value="${file.id}">${file.name} (${new Date(file.createdTime).toLocaleString()})</option>`;
            });
            selectHtml += '</select>';
            
            // Create a custom dialog
            const dialog = document.createElement('div');
            dialog.style.position = 'fixed';
            dialog.style.top = '0';
            dialog.style.left = '0';
            dialog.style.width = '100%';
            dialog.style.height = '100%';
            dialog.style.backgroundColor = 'rgba(0,0,0,0.5)';
            dialog.style.display = 'flex';
            dialog.style.justifyContent = 'center';
            dialog.style.alignItems = 'center';
            dialog.style.zIndex = '1000';
            
            const dialogContent = document.createElement('div');
            dialogContent.style.backgroundColor = 'white';
            dialogContent.style.padding = '20px';
            dialogContent.style.borderRadius = '8px';
            dialogContent.style.width = '50%';
            dialogContent.style.maxWidth = '500px';
            
            dialogContent.innerHTML = `
                <h3 style="margin-bottom: 20px;">Select a backup to load</h3>
                ${selectHtml}
                <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px;">
                    <button id="cancel-btn" style="padding: 8px 16px; background-color: #e5e7eb; color: #374151; border: none; border-radius: 4px; cursor: pointer;">Cancel</button>
                    <button id="load-btn" style="padding: 8px 16px; background-color: #1a56db; color: white; border: none; border-radius: 4px; cursor: pointer;">Load Selected Backup</button>
                </div>
            `;
            
            dialog.appendChild(dialogContent);
            document.body.appendChild(dialog);
            
            // Handle cancel button click
            document.getElementById('cancel-btn').onclick = () => {
                document.body.removeChild(dialog);
                document.getElementById('auth-status').innerHTML = 'Connected to Google Drive';
                document.getElementById('auth-status').style.backgroundColor = '#d1fae5';
            };
            
            // Handle load button click
            document.getElementById('load-btn').onclick = () => {
                const selectedFileId = document.getElementById('backup-select').value;
                document.body.removeChild(dialog);
                
                // Update status
                document.getElementById('auth-status').innerHTML = 'Loading backup...';
                document.getElementById('auth-status').style.backgroundColor = '#fef3c7';
                
                // Download the selected file
                gapi.client.drive.files.get({
                    fileId: selectedFileId,
                    alt: 'media'
                }).then(response => {
                    try {
                        const importedProjects = response.result;
                        
                        // Validate basic structure
                        if (typeof importedProjects !== 'object') {
                            throw new Error('Invalid projects file format');
                        }
                        
                        // Update localStorage
                        localStorage.setItem('publishingProjects', JSON.stringify(importedProjects));
                        
                        document.getElementById('auth-status').innerHTML = 'Successfully loaded backup from Google Drive!';
                        document.getElementById('auth-status').style.backgroundColor = '#d1fae5';
                        
                        alert('Successfully loaded backup from Google Drive! Refresh the page to see your projects.');
                        
                        // Reload the page to show the imported projects
                        setTimeout(() => {
                            window.location.reload();
                        }, 1000);
                    } catch (error) {
                        document.getElementById('auth-status').innerHTML = 'Error loading backup: ' + error.message;
                        document.getElementById('auth-status').style.backgroundColor = '#fee2e2';
                        alert('Error loading backup: ' + error.message);
                    }
                }).catch(error => {
                    document.getElementById('auth-status').innerHTML = 'Error downloading file: ' + error.message;
                    document.getElementById('auth-status').style.backgroundColor = '#fee2e2';
                    alert('Error downloading file from Google Drive: ' + error.message);
                });
            };
        } else {
            document.getElementById('auth-status').innerHTML = 'No backup files found on Google Drive';
            document.getElementById('auth-status').style.backgroundColor = '#fee2e2';
            alert('No backup files found on Google Drive.');
        }
    }).catch(error => {
        document.getElementById('auth-status').innerHTML = 'Error searching Google Drive: ' + error.message;
        document.getElementById('auth-status').style.backgroundColor = '#fee2e2';
        alert('Error searching Google Drive: ' + error.message);
    });
}

// Add this to your existing DOMContentLoaded event handler
// Initialize Google Drive API
initGoogleDriveAPI();

// Add event listeners for Google Drive buttons
document.getElementById('saveToGDriveBtn').addEventListener('click', saveToGoogleDrive);
document.getElementById('loadFromGDriveBtn').addEventListener('click', loadFromGoogleDrive);
document.getElementById('authButton').addEventListener('click', handleAuthClick);
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Link ISBN fields to display in the ISBN Platform table
            document.getElementById('isbnEbook').addEventListener('input', function() {
                document.getElementById('ebookIsbnDisplay').textContent = this.value;
            });
            
            document.getElementById('isbnPaperback').addEventListener('input', function() {
                document.getElementById('paperbackIsbnDisplay').textContent = this.value;
            });
            
            document.getElementById('isbnCaseLaminate').addEventListener('input', function() {
                document.getElementById('laminateIsbnDisplay').textContent = this.value;
            });
            
            document.getElementById('isbnDustJacket').addEventListener('input', function() {
                document.getElementById('dustjacketIsbnDisplay').textContent = this.value;
            });
            
            // Project management variables
            const projectSelect = document.getElementById('projectSelect');
            const loadProjectBtn = document.getElementById('loadProjectBtn');
            const newProjectBtn = document.getElementById('newProjectBtn');
            const deleteProjectBtn = document.getElementById('deleteProjectBtn');
            let currentProjectId = null;
            
            // Task checkbox event listeners
            const taskCheckboxes = document.querySelectorAll('.task-item input[type="checkbox"]');
            taskCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const taskItem = this.closest('.task-item');
                    if (this.checked) {
                        taskItem.classList.add('completed');
                    } else {
                        taskItem.classList.remove('completed');
                    }
                    updatePhaseStatus();
                    updateProjectStatus();
                });
            });
            
            // Print button
            document.getElementById('printButton').addEventListener('click', function() {
                window.print();
            });
            
            // Save progress button
            document.getElementById('saveButton').addEventListener('click', function() {
                if (document.getElementById('bookTitle').value.trim() === '' || 
                    document.getElementById('authorName').value.trim() === '') {
                    alert('Please enter at least the Book Title and Author Name before saving.');
                    return;
                }
                
                saveCurrentProject();
                alert('Progress saved successfully!');
            });
            
            // Reset button
            document.getElementById('resetButton').addEventListener('click', function() {
                if (confirm('Are you sure you want to reset the form? All unsaved progress will be lost.')) {
                    resetForm();
                }
            });
            <!-- Import/Export Section -->
<div class="import-export-section">
    <h2>Import/Export Project Data</h2>
    <div style="display: flex; gap: 15px; flex-wrap: wrap;">
        <div>
            <input type="file" id="importFile" class="file-input" accept=".json">
            <label for="importFile" class="file-label">Import Project</label>
            <span id="fileName" class="file-name"></span>
        </div>
        <button type="button" id="exportButton" class="success">Export Project</button>
    </div>
</div>

<!-- Google Drive Backup Section -->
<div class="import-export-section">
    <h2>Google Drive Backup</h2>
    <div id="google-drive-container" style="margin-top: 15px;">
        <div id="auth-status" style="margin-bottom: 15px; padding: 10px; border-radius: 5px; background-color: #e5e7eb;">
            Not connected to Google Drive
        </div>
        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
            <button type="button" id="authButton" class="success">Connect to Google Drive</button>
            <button type="button" id="saveToGDriveBtn" disabled style="opacity: 0.5">Save to Google Drive</button>
            <button type="button" id="loadFromGDriveBtn" disabled style="opacity: 0.5">Load from Google Drive</button>
        </div>
    </div>
</div>
       // Export button
            document.getElementById('exportButton').addEventListener('click', function() {
                if (document.getElementById('bookTitle').value.trim() === '' || 
                    document.getElementById('authorName').value.trim() === '') {
                    alert('Please enter at least the Book Title and Author Name before exporting.');
                    return;
                }
                
                exportProject();
            });
            
            // Import file change
            document.getElementById('importFile').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    document.getElementById('fileName').textContent = file.name;
                    importProject(file);
                }
            });
            
            // Project selector buttons
            loadProjectBtn.addEventListener('click', function() {
                const selectedProjectId = projectSelect.value;
                if (selectedProjectId) {
                    loadProject(selectedProjectId);
                } else {
                    alert('Please select a project to load.');
                }
            });
            
            newProjectBtn.addEventListener('click', function() {
                if (confirm('Start a new project? Current progress will be saved if possible.')) {
                    if (currentProjectId && (document.getElementById('bookTitle').value.trim() !== '' || 
                        document.getElementById('authorName').value.trim() !== '')) {
                        saveCurrentProject();
                    }
                    resetForm();
                    currentProjectId = null;
                }
            });
            
            deleteProjectBtn.addEventListener('click', function() {
                const selectedProjectId = projectSelect.value;
                if (selectedProjectId) {
                    if (confirm(`Are you sure you want to delete the project "${getProjectName(selectedProjectId)}"? This cannot be undone.`)) {
                        deleteProject(selectedProjectId);
                    }
                } else {
                    alert('Please select a project to delete.');
                }
            });
            
            // Load projects list
            loadProjectsList();
            
            // Functions
            
            // Toggle phase collapse
            window.togglePhase = function(phaseId) {
                const phaseContainer = document.getElementById(phaseId);
                phaseContainer.classList.toggle('collapsed');
            };
            
            function updatePhaseStatus() {
                // Phase 1: Pre-Manuscript
                updateSinglePhaseStatus('phase1Status', 'task1', 'task9');
                
                // Phase 2: Manuscript Development
                updateSinglePhaseStatus('phase2Status', 'task10', 'task15');
                
                // Phase 3: Beta Reader Review
                updateSinglePhaseStatus('phase3Status', 'task16', 'task22');
                
                // Phase 4: Production
                updateSinglePhaseStatus('phase4Status', 'task23', 'task32');
                
                // Phase 5: Account Setup
                updateSinglePhaseStatus('phase5Status', 'task33', 'task39');
                
                // Phase 6: File Upload & QA
                updateSinglePhaseStatus('phase6Status', 'task40', 'task48');
                
                // Phase 7: Publication
                updateSinglePhaseStatus('phase7Status', 'task49', 'task60');
                
                // Phase 8: Post-Publication Support
                updateSinglePhaseStatus('phase8Status', 'task61', 'task67');
            }
            
            function updateSinglePhaseStatus(phaseStatusId, firstTaskId, lastTaskId) {
                const phaseStatus = document.getElementById(phaseStatusId);
                const firstTaskIndex = parseInt(firstTaskId.replace('task', ''));
                const lastTaskIndex = parseInt(lastTaskId.replace('task', ''));
                
                let totalTasks = 0;
                let completedTasks = 0;
                
                for (let i = firstTaskIndex; i <= lastTaskIndex; i++) {
                    const taskCheckbox = document.getElementById('task' + i);
                    if (taskCheckbox) {
                        totalTasks++;
                        if (taskCheckbox.checked) {
                            completedTasks++;
                        }
                    }
                }
                
                if (completedTasks === 0) {
                    phaseStatus.textContent = 'Not Started';
                    phaseStatus.className = 'status status-not-started';
                } else if (completedTasks === totalTasks) {
                    phaseStatus.textContent = 'Completed';
                    phaseStatus.className = 'status status-completed';
                } else {
                    const percentage = Math.round((completedTasks / totalTasks) * 100);
                    phaseStatus.textContent = `In Progress (${percentage}%)`;
                    phaseStatus.className = 'status status-in-progress';
                }
            }
            
            function updateProjectStatus() {
                const currentStatus = document.getElementById('currentStatus');
                const progressBar = document.getElementById('overallProgress');
                const allCheckboxes = document.querySelectorAll('.task-item input[type="checkbox"]');
                const totalTasks = allCheckboxes.length;
                let completedTasks = 0;
                
                allCheckboxes.forEach(checkbox => {
                    if (checkbox.checked) {
                        completedTasks++;
                    }
                });
                
                const percentage = Math.round((completedTasks / totalTasks) * 100);
                progressBar.style.width = percentage + '%';
                
                if (completedTasks === 0) {
                    currentStatus.value = 'Not Started';
                } else if (completedTasks === totalTasks) {
                    currentStatus.value = 'Completed';
                } else {
                    currentStatus.value = `In Progress (${percentage}% complete)`;
                }
            }
            
            function getFormData() {
                const formData = {
                    projectDetails: {
                        bookTitle: document.getElementById('bookTitle').value,
                        authorName: document.getElementById('authorName').value,
                        startDate: document.getElementById('startDate').value,
                        pubDate: document.getElementById('pubDate').value,
                        projectManager: document.getElementById('projectManager').value,
                        launchDate: document.getElementById('launchDate').value
                    },
                    credentials: {
                        authorGmail: document.getElementById('authorGmail').value,
                        authorGmailPass: document.getElementById('authorGmailPass').value,
                        stripeLogin: document.getElementById('stripeLogin').value,
                        stripePass: document.getElementById('stripePass').value,
                        bookVaultLogin: document.getElementById('bookVaultLogin').value,
                        bookVaultPass: document.getElementById('bookVaultPass').value,
                        ingramLogin: document.getElementById('ingramLogin').value,
                        ingramPass: document.getElementById('ingramPass').value,
                        kdpLogin: document.getElementById('kdpLogin').value,
                        kdpPass: document.getElementById('kdpPass').value
                    },
                    isbns: {
                        ebook: document.getElementById('isbnEbook').value,
                        paperback: document.getElementById('isbnPaperback').value,
                        caseLaminate: document.getElementById('isbnCaseLaminate').value,
                        dustJacket: document.getElementById('isbnDustJacket').value
                    },
                    tasks: {}
                };
                
                // Save checkbox states
                document.querySelectorAll('.task-item input[type="checkbox"]').forEach(checkbox => {
                    formData.tasks[checkbox.id] = checkbox.checked;
                });
                
                return formData;
            }
            
            function saveCurrentProject() {
                const formData = getFormData();
                const projectDetails = formData.projectDetails;
                
                if (!projectDetails.bookTitle || !projectDetails.authorName) {
                    alert('Please enter at least the Book Title and Author Name.');
                    return false;
                }
                
                // Create a new project ID if we don't have one
                if (!currentProjectId) {
                    currentProjectId = 'project_' + Date.now();
                }
                
                // Get or initialize the projects object
                const projects = getProjects();
                
                // Add/update current project
                projects[currentProjectId] = {
                    id: currentProjectId,
                    name: `${projectDetails.bookTitle} - ${projectDetails.authorName}`,
                    lastUpdated: new Date().toISOString(),
                    data: formData
                };
                
                // Save to localStorage
                localStorage.setItem('publishingProjects', JSON.stringify(projects));
                
                // Update projects list
                loadProjectsList();
                
                return true;
            }
            
            function loadProject(projectId) {
                const projects = getProjects();
                const project = projects[projectId];
                
                if (!project) {
                    alert('Project not found.');
                    return;
                }
                
                resetForm(); // Clear current form
                
                const formData = project.data;
                
                // Load project details
                for (const key in formData.projectDetails) {
                    const element = document.getElementById(key);
                    if (element) {
                        element.value = formData.projectDetails[key];
                    }
                }
                
                // Load credentials
                for (const key in formData.credentials) {
                    const element = document.getElementById(key);
                    if (element) {
                        element.value = formData.credentials[key];
                    }
                }
                
                // Load ISBNs
                document.getElementById('isbnEbook').value = formData.isbns.ebook || '';
                document.getElementById('isbnPaperback').value = formData.isbns.paperback || '';
                document.getElementById('isbnCaseLaminate').value = formData.isbns.caseLaminate || '';
                document.getElementById('isbnDustJacket').value = formData.isbns.dustJacket || '';
                
                // Update ISBN displays
                document.getElementById('ebookIsbnDisplay').textContent = formData.isbns.ebook || '';
                document.getElementById('paperbackIsbnDisplay').textContent = formData.isbns.paperback || '';
                document.getElementById('laminateIsbnDisplay').textContent = formData.isbns.caseLaminate || '';
                document.getElementById('dustjacketIsbnDisplay').textContent = formData.isbns.dustJacket || '';
                
                // Load task states
                for (const taskId in formData.tasks) {
                    const checkbox = document.getElementById(taskId);
                    if (checkbox) {
                        checkbox.checked = formData.tasks[taskId];
                        const taskItem = checkbox.closest('.task-item');
                        if (checkbox.checked) {
                            taskItem.classList.add('completed');
                        } else {
                            taskItem.classList.remove('completed');
                        }
                    }
                }
                
                // Set current project ID
                currentProjectId = projectId;
                
                // Update status indicators
                updatePhaseStatus();
                updateProjectStatus();
                
                // Update project selector
                projectSelect.value = projectId;
                
                return true;
            }
            
            function deleteProject(projectId) {
                const projects = getProjects();
                
                if (projects[projectId]) {
                    delete projects[projectId];
                    localStorage.setItem('publishingProjects', JSON.stringify(projects));
                    
                    // Update projects list
                    loadProjectsList();
                    
                    // Reset form if we deleted the current project
                    if (currentProjectId === projectId) {
                        resetForm();
                        currentProjectId = null;
                    }
                    
                    return true;
                }
                
                return false;
            }
            
            function resetForm() {
                // Clear all text inputs and date inputs
                document.querySelectorAll('input[type="text"], input[type="date"], input[type="password"], textarea').forEach(input => {
                    input.value = '';
                });
                
                // Uncheck all checkboxes
                document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                    checkbox.checked = false;
                    const taskItem = checkbox.closest('.task-item');
                    if (taskItem) {
                        taskItem.classList.remove('completed');
                    }
                });
                
                // Clear ISBN displays
                document.getElementById('ebookIsbnDisplay').textContent = '';
                document.getElementById('paperbackIsbnDisplay').textContent = '';
                document.getElementById('laminateIsbnDisplay').textContent = '';
                document.getElementById('dustjacketIsbnDisplay').textContent = '';
                
                // Reset status indicators
                updatePhaseStatus();
                updateProjectStatus();
                
                // Expand all phases
                document.querySelectorAll('.phase-container').forEach(container => {
                    container.classList.remove('collapsed');
                });
            }
            
            function getProjects() {
                const projectsString = localStorage.getItem('publishingProjects');
                return projectsString ? JSON.parse(projectsString) : {};
            }
            
            function getProjectName(projectId) {
                const projects = getProjects();
                return projects[projectId] ? projects[projectId].name : 'Unknown Project';
            }
            
            function loadProjectsList() {
                const projects = getProjects();
                projectSelect.innerHTML = '<option value="">-- Select a saved project --</option>';
                
                // Sort projects by last updated date (newest first)
                const sortedProjects = Object.values(projects).sort((a, b) => {
                    return new Date(b.lastUpdated) - new Date(a.lastUpdated);
                });
                
                sortedProjects.forEach(project => {
                    const option = document.createElement('option');
                    option.value = project.id;
                    option.textContent = project.name;
                    if (project.id === currentProjectId) {
                        option.selected = true;
                    }
                    projectSelect.appendChild(option);
                });
            }
            
            function exportProject() {
                // Save current project first
                if (!saveCurrentProject()) {
                    return;
                }
                
                const projects = getProjects();
                const project = projects[currentProjectId];
                
                // Create and download export file
                const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(project, null, 2));
                const downloadAnchorNode = document.createElement('a');
                downloadAnchorNode.setAttribute("href", dataStr);
                downloadAnchorNode.setAttribute("download", `${project.data.projectDetails.bookTitle.replace(/[^a-z0-9]/gi, '_').toLowerCase()}-export.json`);
                document.body.appendChild(downloadAnchorNode);
                downloadAnchorNode.click();
                downloadAnchorNode.remove();
            }
            
            function importProject(file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const project = JSON.parse(e.target.result);
                        
                        // Validate basic project structure
                        if (!project.id || !project.data || !project.data.projectDetails) {
                            throw new Error('Invalid project file format');
                        }
                        
                        // Generate a new project ID to avoid overwriting existing projects
                        const newProjectId = 'project_' + Date.now();
                        project.id = newProjectId;
                        
                        // Add to projects list
                        const projects = getProjects();
                        projects[newProjectId] = project;
                        localStorage.setItem('publishingProjects', JSON.stringify(projects));
                        
                        // Load the imported project
                        loadProjectsList();
                        loadProject(newProjectId);
                        
                        alert('Project imported successfully!');
                    } catch (error) {
                        alert('Error importing project: ' + error.message);
                        document.getElementById('fileName').textContent = '';
                    }
                };
                reader.readAsText(file);
            }
            
            // Initialize UI
            updatePhaseStatus();
            updateProjectStatus();
            
            // Auto save every 5 minutes
            setInterval(function() {
                if (currentProjectId && (document.getElementById('bookTitle').value.trim() !== '' || 
                    document.getElementById('authorName').value.trim() !== '')) {
                    saveCurrentProject();
                    console.log('Auto-saved at ' + new Date().toLocaleTimeString());
                }
            }, 300000); // 5 minutes
